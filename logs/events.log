[2025-05-13 08:25:24] [EVENT] Bootstrap: .env cargado.
[2025-05-13 08:25:24] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 08:25:24] [EVENT] Bootstrap: .env cargado.
[2025-05-13 08:25:24] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 08:25:27] [EVENT] Bootstrap: .env cargado.
[2025-05-13 08:25:27] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 08:25:29] [EVENT] Bootstrap: .env cargado.
[2025-05-13 08:25:29] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 08:25:29] [EVENT] Endpoint create_subscription_session.php: Solicitud recibida.
[2025-05-13 08:25:29] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl inicializado con appDomainBase: http://localhost:8000/public
[2025-05-13 08:25:29] [EVENT] Bootstrap: StripeCheckoutSessionService instanciado.
[2025-05-13 08:25:29] [EVENT] create_subscription_session.php: Llamando a createSubscriptionSession. - Context: {"lookup_key":"annual_payment"}
[2025-05-13 08:25:29] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Creando sesión de suscripción. - Context: {"lookup_key":"annual_payment"}
[2025-05-13 08:25:29] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Buscando Price ID. - Context: {"lookup_key":"annual_payment","context":"suscripción"}
[2025-05-13 08:25:30] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Price ID encontrado. - Context: {"lookup_key":"annual_payment","price_id":"price_1RLNsHP71JLI6sb9ez8HJsHt"}
[2025-05-13 08:25:30] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: URLs para suscripción. - Context: {"success":"http://localhost:8000/public/success.html?session_id={CHECKOUT_SESSION_ID}","cancel":"http://localhost:8000/public/cancel.html"}
[2025-05-13 08:25:30] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Sesión de suscripción creada. - Context: {"session_id":"cs_test_a15Bv1av2e2zsWg1WB7c8Hxv63wl4FHW1OakVPZ5fiTTKx9UU6W7t1ZfTw","price_id":"price_1RLNsHP71JLI6sb9ez8HJsHt"}
[2025-05-13 08:25:30] [EVENT] create_subscription_session.php: Sesión de suscripción creada. - Context: {"session_id":"cs_test_a15Bv1av2e2zsWg1WB7c8Hxv63wl4FHW1OakVPZ5fiTTKx9UU6W7t1ZfTw"}
[2025-05-13 08:47:51] [EVENT] Bootstrap: .env cargado.
[2025-05-13 08:47:51] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 18:48:36] [EVENT] Bootstrap: .env cargado.
[2025-05-13 18:48:36] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:33] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:33] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:41] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:41] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:42] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:42] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:42] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:42] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:43] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:43] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:44] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:44] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:44] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:44] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:46] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:46] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:46] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:46] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:50] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:50] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:56] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:56] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:41:56] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:41:56] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:42:00] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:42:00] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:42:00] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:42:00] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:42:45] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:42:45] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:42:50] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:42:50] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:42:50] [EVENT] Endpoint create_payment_session.php: Solicitud recibida.
[2025-05-13 19:42:50] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl inicializado con appDomainBase: http://localhost:8000/public
[2025-05-13 19:42:50] [EVENT] Bootstrap: StripeCheckoutSessionService instanciado.
[2025-05-13 19:42:50] [EVENT] create_payment_session.php: Llamando a createOneTimePaymentSession. - Context: {"lookup_key":"one_payment"}
[2025-05-13 19:42:50] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Creando sesión de pago único. - Context: {"lookup_key":"one_payment"}
[2025-05-13 19:42:50] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Buscando Price ID. - Context: {"lookup_key":"one_payment","context":"pago único"}
[2025-05-13 19:42:50] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Price ID encontrado. - Context: {"lookup_key":"one_payment","price_id":"price_1RLNYIP71JLI6sb99HofbYd0"}
[2025-05-13 19:42:50] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: URLs para pago único. - Context: {"success":"http://localhost:8000/public/success.html?session_id={CHECKOUT_SESSION_ID}","cancel":"http://localhost:8000/public/cancel.html"}
[2025-05-13 19:42:50] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Sesión de pago único creada. - Context: {"session_id":"cs_test_a1KmJEhHpjWUrdn1XSsitqba9RuY7kpkQtyB8qK0fsJKa3zwQXAfEAhQFR","price_id":"price_1RLNYIP71JLI6sb99HofbYd0"}
[2025-05-13 19:42:50] [EVENT] create_payment_session.php: Sesión de pago único creada. - Context: {"session_id":"cs_test_a1KmJEhHpjWUrdn1XSsitqba9RuY7kpkQtyB8qK0fsJKa3zwQXAfEAhQFR"}
[2025-05-13 19:43:01] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:43:01] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:53:35] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:53:35] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:53:35] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:53:35] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:53:42] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:53:42] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:55:37] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:55:37] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:55:38] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:55:38] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:55:38] [EVENT] Endpoint create_subscription_session.php: Solicitud recibida.
[2025-05-13 19:55:38] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl inicializado con appDomainBase: http://localhost:8000/public
[2025-05-13 19:55:38] [EVENT] Bootstrap: StripeCheckoutSessionService instanciado.
[2025-05-13 19:55:38] [EVENT] create_subscription_session.php: Llamando a createSubscriptionSession. - Context: {"lookup_key":"monthly_subscriptions"}
[2025-05-13 19:55:38] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Creando sesión de suscripción. - Context: {"lookup_key":"monthly_subscriptions"}
[2025-05-13 19:55:38] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Buscando Price ID. - Context: {"lookup_key":"monthly_subscriptions","context":"suscripción"}
[2025-05-13 19:55:39] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Price ID encontrado. - Context: {"lookup_key":"monthly_subscriptions","price_id":"price_1RLNcyP71JLI6sb92qc9ywRx"}
[2025-05-13 19:55:39] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: URLs para suscripción. - Context: {"success":"http://localhost:8000/public/success.html?session_id={CHECKOUT_SESSION_ID}","cancel":"http://localhost:8000/public/cancel.html"}
[2025-05-13 19:55:39] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Sesión de suscripción creada. - Context: {"session_id":"cs_test_a1AZrRRxCz9RkLAgK5EvhDM5ZBU7fioGycgDo7bkn24bkSa348D0wIY5ro","price_id":"price_1RLNcyP71JLI6sb92qc9ywRx"}
[2025-05-13 19:55:39] [EVENT] create_subscription_session.php: Sesión de suscripción creada. - Context: {"session_id":"cs_test_a1AZrRRxCz9RkLAgK5EvhDM5ZBU7fioGycgDo7bkn24bkSa348D0wIY5ro"}
[2025-05-13 19:56:03] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:56:03] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:56:03] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:56:03] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:56:03] [EVENT] Bootstrap: StripeInvoiceController instanciado.
[2025-05-13 19:56:03] [EVENT] API Invoices: Endpoint alcanzado con acción: list_all
[2025-05-13 19:56:03] [EVENT] API Invoices: Solicitud para listar todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 19:56:03] [EVENT] App\Controller\Impl\StripeInvoiceControllerImpl: Solicitando todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 19:56:07] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:56:07] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:56:07] [EVENT] Bootstrap: StripeInvoiceController instanciado.
[2025-05-13 19:56:07] [EVENT] API Invoices: Endpoint alcanzado con acción: list_all
[2025-05-13 19:56:07] [EVENT] API Invoices: Solicitud para listar todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 19:56:07] [EVENT] App\Controller\Impl\StripeInvoiceControllerImpl: Solicitando todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 19:56:09] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:56:09] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:56:09] [EVENT] Bootstrap: StripeInvoiceController instanciado.
[2025-05-13 19:56:09] [EVENT] API Invoices: Endpoint alcanzado con acción: list_all
[2025-05-13 19:56:09] [EVENT] API Invoices: Solicitud para listar todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 19:56:09] [EVENT] App\Controller\Impl\StripeInvoiceControllerImpl: Solicitando todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 19:56:38] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:56:38] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:56:38] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:56:38] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:56:38] [EVENT] Bootstrap: GlobalStripeClient instanciado.
[2025-05-13 19:56:38] [EVENT] Bootstrap: StripeSubscriptionManagementService instanciado.
[2025-05-13 19:56:38] [EVENT] Bootstrap: StripeSubscriptionController instanciado.
[2025-05-13 19:56:38] [EVENT] API [api-subscriptions.php]: Solicitud para listar TODAS las suscripciones del sistema. - Context: {"page":1,"limit":5}
[2025-05-13 19:56:38] [EVENT] App\Controller\Impl\StripeSubscriptionControllerImpl: Solicitando todas las suscripciones. - Context: {"page":1,"limit":5}
[2025-05-13 19:56:41] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:56:41] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:56:41] [EVENT] Bootstrap: GlobalStripeClient instanciado.
[2025-05-13 19:56:41] [EVENT] Bootstrap: StripeSubscriptionManagementService instanciado.
[2025-05-13 19:56:41] [EVENT] Bootstrap: StripeSubscriptionController instanciado.
[2025-05-13 19:56:41] [EVENT] API [api-subscriptions.php]: Solicitud para listar TODAS las suscripciones del sistema. - Context: {"page":1,"limit":5}
[2025-05-13 19:56:41] [EVENT] App\Controller\Impl\StripeSubscriptionControllerImpl: Solicitando todas las suscripciones. - Context: {"page":1,"limit":5}
[2025-05-13 19:57:12] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:12] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:14] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:14] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:17] [EVENT] Bootstrap: GlobalStripeClient instanciado.
[2025-05-13 19:57:17] [EVENT] Bootstrap: StripeSubscriptionManagementService instanciado.
[2025-05-13 19:57:17] [EVENT] Bootstrap: StripeSubscriptionController instanciado.
[2025-05-13 19:57:17] [EVENT] API [api-subscriptions.php]: Solicitud para listar TODAS las suscripciones del sistema. - Context: {"page":1,"limit":5}
[2025-05-13 19:57:17] [EVENT] App\Controller\Impl\StripeSubscriptionControllerImpl: Solicitando todas las suscripciones. - Context: {"page":1,"limit":5}
[2025-05-13 19:57:19] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:19] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:19] [EVENT] Bootstrap: GlobalStripeClient instanciado.
[2025-05-13 19:57:19] [EVENT] Bootstrap: StripeSubscriptionManagementService instanciado.
[2025-05-13 19:57:19] [EVENT] Bootstrap: StripeSubscriptionController instanciado.
[2025-05-13 19:57:19] [EVENT] API [api-subscriptions.php]: Solicitud para listar TODAS las suscripciones del sistema. - Context: {"page":1,"limit":5}
[2025-05-13 19:57:19] [EVENT] App\Controller\Impl\StripeSubscriptionControllerImpl: Solicitando todas las suscripciones. - Context: {"page":1,"limit":5}
[2025-05-13 19:57:21] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:21] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:23] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:23] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:24] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:24] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:24] [EVENT] Endpoint create_subscription_session.php: Solicitud recibida.
[2025-05-13 19:57:24] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl inicializado con appDomainBase: http://localhost:8000/public
[2025-05-13 19:57:24] [EVENT] Bootstrap: StripeCheckoutSessionService instanciado.
[2025-05-13 19:57:24] [EVENT] create_subscription_session.php: Llamando a createSubscriptionSession. - Context: {"lookup_key":"annual_payment"}
[2025-05-13 19:57:24] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Creando sesión de suscripción. - Context: {"lookup_key":"annual_payment"}
[2025-05-13 19:57:24] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Buscando Price ID. - Context: {"lookup_key":"annual_payment","context":"suscripción"}
[2025-05-13 19:57:25] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Price ID encontrado. - Context: {"lookup_key":"annual_payment","price_id":"price_1RLNsHP71JLI6sb9ez8HJsHt"}
[2025-05-13 19:57:25] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: URLs para suscripción. - Context: {"success":"http://localhost:8000/public/success.html?session_id={CHECKOUT_SESSION_ID}","cancel":"http://localhost:8000/public/cancel.html"}
[2025-05-13 19:57:25] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Sesión de suscripción creada. - Context: {"session_id":"cs_test_a1TRO0R29G5Q2Up72f32a6qQ2yQuTowzGiQA5PIm7eY97yykidDfheKqEx","price_id":"price_1RLNsHP71JLI6sb9ez8HJsHt"}
[2025-05-13 19:57:25] [EVENT] create_subscription_session.php: Sesión de suscripción creada. - Context: {"session_id":"cs_test_a1TRO0R29G5Q2Up72f32a6qQ2yQuTowzGiQA5PIm7eY97yykidDfheKqEx"}
[2025-05-13 19:57:51] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:51] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:51] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:51] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:51] [EVENT] Bootstrap: StripeInvoiceController instanciado.
[2025-05-13 19:57:51] [EVENT] API Invoices: Endpoint alcanzado con acción: list_all
[2025-05-13 19:57:51] [EVENT] API Invoices: Solicitud para listar todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 19:57:51] [EVENT] App\Controller\Impl\StripeInvoiceControllerImpl: Solicitando todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 19:57:53] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:53] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:53] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:53] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:53] [EVENT] Bootstrap: StripeInvoiceController instanciado.
[2025-05-13 19:57:53] [EVENT] API Invoices: Endpoint alcanzado con acción: list_all
[2025-05-13 19:57:53] [EVENT] API Invoices: Solicitud para listar todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 19:57:53] [EVENT] App\Controller\Impl\StripeInvoiceControllerImpl: Solicitando todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 19:57:54] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:54] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:55] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:57:55] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:57:55] [EVENT] Bootstrap: GlobalStripeClient instanciado.
[2025-05-13 19:57:55] [EVENT] Bootstrap: StripeSubscriptionManagementService instanciado.
[2025-05-13 19:57:55] [EVENT] Bootstrap: StripeSubscriptionController instanciado.
[2025-05-13 19:57:55] [EVENT] API [api-subscriptions.php]: Solicitud para listar TODAS las suscripciones del sistema. - Context: {"page":1,"limit":5}
[2025-05-13 19:57:55] [EVENT] App\Controller\Impl\StripeSubscriptionControllerImpl: Solicitando todas las suscripciones. - Context: {"page":1,"limit":5}
[2025-05-13 19:59:04] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:59:04] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:59:05] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:59:05] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:59:06] [EVENT] Bootstrap: .env cargado.
[2025-05-13 19:59:06] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 19:59:06] [EVENT] Endpoint create_payment_session.php: Solicitud recibida.
[2025-05-13 19:59:06] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl inicializado con appDomainBase: http://localhost:8000/public
[2025-05-13 19:59:06] [EVENT] Bootstrap: StripeCheckoutSessionService instanciado.
[2025-05-13 19:59:06] [EVENT] create_payment_session.php: Llamando a createOneTimePaymentSession. - Context: {"lookup_key":"one_payment"}
[2025-05-13 19:59:06] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Creando sesión de pago único. - Context: {"lookup_key":"one_payment"}
[2025-05-13 19:59:06] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Buscando Price ID. - Context: {"lookup_key":"one_payment","context":"pago único"}
[2025-05-13 19:59:06] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Price ID encontrado. - Context: {"lookup_key":"one_payment","price_id":"price_1RLNYIP71JLI6sb99HofbYd0"}
[2025-05-13 19:59:06] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: URLs para pago único. - Context: {"success":"http://localhost:8000/public/success.html?session_id={CHECKOUT_SESSION_ID}","cancel":"http://localhost:8000/public/cancel.html"}
[2025-05-13 19:59:07] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Sesión de pago único creada. - Context: {"session_id":"cs_test_a1wvjSRLjr0b2q9SyRWl41kokCVWUzSyVv7il9y3NyoJ6Uzv0EpIOBzZou","price_id":"price_1RLNYIP71JLI6sb99HofbYd0"}
[2025-05-13 19:59:07] [EVENT] create_payment_session.php: Sesión de pago único creada. - Context: {"session_id":"cs_test_a1wvjSRLjr0b2q9SyRWl41kokCVWUzSyVv7il9y3NyoJ6Uzv0EpIOBzZou"}
[2025-05-13 20:00:42] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:00:42] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:00:42] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:00:42] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:00:42] [EVENT] Bootstrap: StripeInvoiceController instanciado.
[2025-05-13 20:00:42] [EVENT] API Invoices: Endpoint alcanzado con acción: list_all
[2025-05-13 20:00:42] [EVENT] API Invoices: Solicitud para listar todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 20:00:42] [EVENT] App\Controller\Impl\StripeInvoiceControllerImpl: Solicitando todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 20:00:44] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:00:44] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:01:47] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:01:47] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:01:48] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:01:48] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:01:51] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:01:51] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:01:52] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:01:52] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:01:52] [EVENT] Endpoint create_subscription_session.php: Solicitud recibida.
[2025-05-13 20:01:52] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl inicializado con appDomainBase: http://localhost:8000/public
[2025-05-13 20:01:52] [EVENT] Bootstrap: StripeCheckoutSessionService instanciado.
[2025-05-13 20:01:52] [EVENT] create_subscription_session.php: Llamando a createSubscriptionSession. - Context: {"lookup_key":"monthly_subscriptions"}
[2025-05-13 20:01:52] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Creando sesión de suscripción. - Context: {"lookup_key":"monthly_subscriptions"}
[2025-05-13 20:01:52] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Buscando Price ID. - Context: {"lookup_key":"monthly_subscriptions","context":"suscripción"}
[2025-05-13 20:01:52] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Price ID encontrado. - Context: {"lookup_key":"monthly_subscriptions","price_id":"price_1RLNcyP71JLI6sb92qc9ywRx"}
[2025-05-13 20:01:52] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: URLs para suscripción. - Context: {"success":"http://localhost:8000/public/success.html?session_id={CHECKOUT_SESSION_ID}","cancel":"http://localhost:8000/public/cancel.html"}
[2025-05-13 20:01:52] [EVENT] App\Service\Impl\StripeCheckoutSessionServiceImpl: Sesión de suscripción creada. - Context: {"session_id":"cs_test_a1bgZdfgAUn3ie76ZuOI2cDNNf7L6O28l6JucApm6Lhq4bmerWVxi06rtg","price_id":"price_1RLNcyP71JLI6sb92qc9ywRx"}
[2025-05-13 20:01:52] [EVENT] create_subscription_session.php: Sesión de suscripción creada. - Context: {"session_id":"cs_test_a1bgZdfgAUn3ie76ZuOI2cDNNf7L6O28l6JucApm6Lhq4bmerWVxi06rtg"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90NsVMzJW","event_type":"charge.succeeded"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90NsVMzJW","event_type":"charge.succeeded"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia encontrada, procesando... - Context: {"event_id":"evt_3ROP1nP71JLI6sb90NsVMzJW","event_type":"charge.succeeded","strategy_class":"App\\Strategy\\Impl\\ChargeSucceededStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\ChargeSucceededStrategyImpl: Iniciando procesamiento. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90NsVMzJW","event_type":"charge.succeeded"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\ChargeSucceededStrategyImpl: Charge DTO mapeado. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90NsVMzJW","charge_id":"ch_3ROP1nP71JLI6sb902xe7tT3","pi_id":"pi_3ROP1nP71JLI6sb90Lh9QvEd","receipt_url":"https://pay.stripe.com/receipts/invoices/CAcaFwoVYWNjdF8xUkhKNjFQNzFKTEk2c2I5KMnKjsEGMgZnkyZCdHM6LBbgXZCTZrcMLQZHl-s3lTPZfTnZ79NaD2xO8grgM5wER1s1MFn6kcd36reC?s=ap"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\ChargeSucceededStrategyImpl: No se encontró transacción asociada al Payment Intent del Charge. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90NsVMzJW","pi_id":"pi_3ROP1nP71JLI6sb90Lh9QvEd","charge_id":"ch_3ROP1nP71JLI6sb902xe7tT3"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\ChargeSucceededStrategyImpl: Procesamiento completado. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90NsVMzJW","charge_id":"ch_3ROP1nP71JLI6sb902xe7tT3"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia procesada exitosamente. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90NsVMzJW","strategy_class":"App\\Strategy\\Impl\\ChargeSucceededStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook procesado exitosamente. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90NsVMzJW"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb91xI1Z7bo","event_type":"payment_method.attached"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb91xI1Z7bo","event_type":"payment_method.attached"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: No se encontró estrategia aplicable (payload logueado en unhandled_stripe_events.log). - Context: {"event_id":"evt_1ROP1pP71JLI6sb91xI1Z7bo","event_type":"payment_method.attached"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: No se encontró estrategia aplicable. - Context: {"event_type":"payment_method.attached","event_id":"evt_1ROP1pP71JLI6sb91xI1Z7bo"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9Imvyrc3P","event_type":"customer.created"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9Imvyrc3P","event_type":"customer.created"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia encontrada, procesando... - Context: {"event_id":"evt_1ROP1pP71JLI6sb9Imvyrc3P","event_type":"customer.created","strategy_class":"App\\Strategy\\Impl\\CustomerCreatedOrUpdatedStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\CustomerCreatedOrUpdatedStrategyImpl: Iniciando procesamiento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9Imvyrc3P","event_type":"customer.created"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\CustomerCreatedOrUpdatedStrategyImpl: Customer DTO mapeado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9Imvyrc3P","customer_id":"cus_SJ13BPsY6XHn0L","email":"contacto@josecarlosdev.com","name":"suscripcion mensual"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\CustomerCreatedOrUpdatedStrategyImpl: Procesamiento completado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9Imvyrc3P","customer_id":"cus_SJ13BPsY6XHn0L"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia procesada exitosamente. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9Imvyrc3P","strategy_class":"App\\Strategy\\Impl\\CustomerCreatedOrUpdatedStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook procesado exitosamente. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9Imvyrc3P"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9D6EBsy3E","event_type":"customer.updated"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9D6EBsy3E","event_type":"customer.updated"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia encontrada, procesando... - Context: {"event_id":"evt_1ROP1pP71JLI6sb9D6EBsy3E","event_type":"customer.updated","strategy_class":"App\\Strategy\\Impl\\CustomerCreatedOrUpdatedStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\CustomerCreatedOrUpdatedStrategyImpl: Iniciando procesamiento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9D6EBsy3E","event_type":"customer.updated"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\CustomerCreatedOrUpdatedStrategyImpl: Customer DTO mapeado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9D6EBsy3E","customer_id":"cus_SJ13BPsY6XHn0L","email":"contacto@josecarlosdev.com","name":"suscripcion mensual"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\CustomerCreatedOrUpdatedStrategyImpl: Procesamiento completado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9D6EBsy3E","customer_id":"cus_SJ13BPsY6XHn0L"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia procesada exitosamente. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9D6EBsy3E","strategy_class":"App\\Strategy\\Impl\\CustomerCreatedOrUpdatedStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook procesado exitosamente. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9D6EBsy3E"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9rdoHy4Gv","event_type":"checkout.session.completed"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9rdoHy4Gv","event_type":"checkout.session.completed"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia encontrada, procesando... - Context: {"event_id":"evt_1ROP1pP71JLI6sb9rdoHy4Gv","event_type":"checkout.session.completed","strategy_class":"App\\Strategy\\Impl\\CheckoutSessionCompletedStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\CheckoutSessionCompletedStrategyImpl: Iniciando procesamiento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9rdoHy4Gv","event_type":"checkout.session.completed"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\CheckoutSessionCompletedStrategyImpl: DTO CheckoutSession mapeado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9rdoHy4Gv","cs_id":"cs_test_a1bgZdfgAUn3ie76ZuOI2cDNNf7L6O28l6JucApm6Lhq4bmerWVxi06rtg","mode":"subscription","customer_id_stripe":"cus_SJ13BPsY6XHn0L","customer_email":"contacto@josecarlosdev.com","payment_intent_id":null,"subscription_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\CheckoutSessionCompletedStrategyImpl: Suscripción de Checkout aún no en BD (se esperará a customer.subscription.created). - Context: {"sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX","email_from_cs":"contacto@josecarlosdev.com"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\CheckoutSessionCompletedStrategyImpl: Procesamiento completado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9rdoHy4Gv","cs_id":"cs_test_a1bgZdfgAUn3ie76ZuOI2cDNNf7L6O28l6JucApm6Lhq4bmerWVxi06rtg"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia procesada exitosamente. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9rdoHy4Gv","strategy_class":"App\\Strategy\\Impl\\CheckoutSessionCompletedStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook procesado exitosamente. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9rdoHy4Gv"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9NcQczuvB","event_type":"customer.subscription.created"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9NcQczuvB","event_type":"customer.subscription.created"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia encontrada, procesando... - Context: {"event_id":"evt_1ROP1pP71JLI6sb9NcQczuvB","event_type":"customer.subscription.created","strategy_class":"App\\Strategy\\Impl\\SubscriptionCreatedStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\SubscriptionCreatedStrategyImpl: Iniciando procesamiento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9NcQczuvB","event_type":"customer.subscription.created"}
[2025-05-13 20:02:17] [EVENT] SubscriptionMapper DEBUG: Objeto payload recibido. - Context: {"class":"Stripe\\Subscription","json_representation_snippet":"{\n    \"id\": \"sub_1ROP1oP71JLI6sb9M2FhWZGX\",\n    \"object\": \"subscription\",\n    \"application\": null,\n    \"application_fee_percent\": null,\n    \"automatic_tax\": {\n        \"disabled_reason\": null,\n        \"enabled\": false,\n        \"liability\": null\n    },\n    \"billing_cycle_anchor\": 1747166534,\n    \"billing_cycle_anchor_config\": null,\n    \"cancel_at\": null,\n    \"cancel_at_period_end\": false,\n    \"canceled_at\": null,\n    \"cancellation_details\": {\n        \"comment\": null,\n        \"feedback\": null,\n        \"reason\": null\n    },\n    \"collection_method\": \"charge_automatically\",\n    \"created\": 1747166534,\n    \"currency\": \"eur\",\n    \"customer\": \"cus_SJ13BPsY6XHn0L\",\n    \"days_until_due\": null,\n    \"default_payment_method\": \"pm_1ROP1mP71JLI6sb9S5pV2tHO\",\n    \"default_source\": null,\n    \"default_tax_rates\": [],\n    \"description\": null,\n    \"discounts\": [],\n    \"ended_at\": null,\n    \"invoice_settings\": {\n        \"account_tax_ids\": null,\n        \"issuer\": {\n            \"type\": \"self\"\n        }\n    },\n"}
[2025-05-13 20:02:17] [EVENT] SubscriptionMapper: Usando 'start_date' como 'current_period_start'. - Context: {"sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:17] [EVENT] SubscriptionMapper: Usando 'items.data[0].current_period_end'. - Context: {"sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\SubscriptionCreatedStrategyImpl: Subscription DTO mapeado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9NcQczuvB","sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX","customer_id":"cus_SJ13BPsY6XHn0L","status":"active"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\SubscriptionCreatedStrategyImpl: Intentando obtener Customer para email. - Context: {"customer_id":"cus_SJ13BPsY6XHn0L"}
[2025-05-13 20:02:17] [EVENT] SubscriptionModelFactory: Creando SubscriptionsModel desde SubscriptionDTO. - Context: {"sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:17] [EVENT] SubscriptionModelFactory: SubscriptionsModel creado exitosamente. - Context: {"sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\SubscriptionCreatedStrategyImpl: Nueva suscripción creada y guardada. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9NcQczuvB","sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\SubscriptionCreatedStrategyImpl: Procesamiento completado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9NcQczuvB","sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia procesada exitosamente. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9NcQczuvB","strategy_class":"App\\Strategy\\Impl\\SubscriptionCreatedStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook procesado exitosamente. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9NcQczuvB"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90tUpEJVZ","event_type":"payment_intent.succeeded"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90tUpEJVZ","event_type":"payment_intent.succeeded"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia encontrada, procesando... - Context: {"event_id":"evt_3ROP1nP71JLI6sb90tUpEJVZ","event_type":"payment_intent.succeeded","strategy_class":"App\\Strategy\\Impl\\PaymentIntentSucceededStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\PaymentIntentSucceededStrategyImpl: Iniciando procesamiento. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90tUpEJVZ","event_type":"payment_intent.succeeded"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\PaymentIntentSucceededStrategyImpl: PaymentIntent DTO mapeado. - Context: {"pi_id":"pi_3ROP1nP71JLI6sb90Lh9QvEd","description":"Subscription creation","invoice_id_in_pi_dto":null}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\PaymentIntentSucceededStrategyImpl: Descripción del PI sugiere pago de suscripción/factura. - Context: {"pi_id":"pi_3ROP1nP71JLI6sb90Lh9QvEd","description":"Subscription creation"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\PaymentIntentSucceededStrategyImpl: PaymentIntent parece ser para una factura/suscripción (ID: N/A). No se creará una transacción 'one_time_receipt' separada. Se espera que InvoicePaidStrategy maneje la creación de la transacción para la factura. - Context: {"pi_id":"pi_3ROP1nP71JLI6sb90Lh9QvEd","event_id":"evt_3ROP1nP71JLI6sb90tUpEJVZ"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia procesada exitosamente. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90tUpEJVZ","strategy_class":"App\\Strategy\\Impl\\PaymentIntentSucceededStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook procesado exitosamente. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90tUpEJVZ"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90mB4Gwsw","event_type":"payment_intent.created"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_3ROP1nP71JLI6sb90mB4Gwsw","event_type":"payment_intent.created"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: No se encontró estrategia aplicable (payload logueado en unhandled_stripe_events.log). - Context: {"event_id":"evt_3ROP1nP71JLI6sb90mB4Gwsw","event_type":"payment_intent.created"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: No se encontró estrategia aplicable. - Context: {"event_type":"payment_intent.created","event_id":"evt_3ROP1nP71JLI6sb90mB4Gwsw"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb91l6CEPaD","event_type":"invoice.created"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb91l6CEPaD","event_type":"invoice.created"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: No se encontró estrategia aplicable (payload logueado en unhandled_stripe_events.log). - Context: {"event_id":"evt_1ROP1pP71JLI6sb91l6CEPaD","event_type":"invoice.created"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: No se encontró estrategia aplicable. - Context: {"event_type":"invoice.created","event_id":"evt_1ROP1pP71JLI6sb91l6CEPaD"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb97aD1XVID","event_type":"invoice.finalized"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb97aD1XVID","event_type":"invoice.finalized"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: No se encontró estrategia aplicable (payload logueado en unhandled_stripe_events.log). - Context: {"event_id":"evt_1ROP1pP71JLI6sb97aD1XVID","event_type":"invoice.finalized"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: No se encontró estrategia aplicable. - Context: {"event_type":"invoice.finalized","event_id":"evt_1ROP1pP71JLI6sb97aD1XVID"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb921ZBtgR5","event_type":"invoice.paid"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb921ZBtgR5","event_type":"invoice.paid"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia encontrada, procesando... - Context: {"event_id":"evt_1ROP1pP71JLI6sb921ZBtgR5","event_type":"invoice.paid","strategy_class":"App\\Strategy\\Impl\\InvoicePaidStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\InvoicePaidStrategyImpl: Iniciando procesamiento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb921ZBtgR5","event_type":"invoice.paid"}
[2025-05-13 20:02:17] [EVENT] InvoiceMapper DEBUG: Objeto payload recibido. - Context: {"class":"Stripe\\Invoice","json_representation_snippet":"{\n    \"id\": \"in_1ROP1oP71JLI6sb9IScYQQku\",\n    \"object\": \"invoice\",\n    \"account_country\": \"ES\",\n    \"account_name\": \"Stripe Lab App\",\n    \"account_tax_ids\": null,\n    \"amount_due\": 300,\n    \"amount_overpaid\": 0,\n    \"amount_paid\": 300,\n    \"amount_remaining\": 0,\n    \"amount_shipping\": 0,\n    \"application\": null,\n    \"attempt_count\": 0,\n    \"attempted\": true,\n    \"auto_advance\": false,\n    \"automatic_tax\": {\n        \"disabled_reason\": null,\n        \"enabled\": false,\n        \"liability\": null,\n  "}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\InvoicePaidStrategyImpl: Invoice DTO mapeado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb921ZBtgR5","invoice_id":"in_1ROP1oP71JLI6sb9IScYQQku","subscription_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX","amount_paid":300}
[2025-05-13 20:02:17] [EVENT] TransactionModelFactory: Preparando TransactionsModel desde InvoiceDTO. - Context: {"invoice_id":"in_1ROP1oP71JLI6sb9IScYQQku"}
[2025-05-13 20:02:17] [EVENT] TransactionModelFactory: TransactionsModel (sin ID local aún) preparado desde InvoiceDTO. - Context: {"invoice_id":"in_1ROP1oP71JLI6sb9IScYQQku"}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\InvoicePaidStrategyImpl: Transacción creada para Invoice pagada. - Context: {"event_id":"evt_1ROP1pP71JLI6sb921ZBtgR5","invoice_id":"in_1ROP1oP71JLI6sb9IScYQQku","transaction_id_local":1}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\InvoicePaidStrategyImpl: latest_transaction_id actualizado en la suscripción. - Context: {"event_id":"evt_1ROP1pP71JLI6sb921ZBtgR5","subscription_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX","latest_transaction_id":1}
[2025-05-13 20:02:17] [EVENT] App\Strategy\Impl\InvoicePaidStrategyImpl: Procesamiento completado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb921ZBtgR5","invoice_id":"in_1ROP1oP71JLI6sb9IScYQQku"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Estrategia procesada exitosamente. - Context: {"event_id":"evt_1ROP1pP71JLI6sb921ZBtgR5","strategy_class":"App\\Strategy\\Impl\\InvoicePaidStrategyImpl"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook procesado exitosamente. - Context: {"event_id":"evt_1ROP1pP71JLI6sb921ZBtgR5"}
[2025-05-13 20:02:17] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:17] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:17] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:17] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9bY4DfRSy","event_type":"invoice.payment_succeeded"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_1ROP1pP71JLI6sb9bY4DfRSy","event_type":"invoice.payment_succeeded"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookService: No se encontró estrategia aplicable (payload logueado en unhandled_stripe_events.log). - Context: {"event_id":"evt_1ROP1pP71JLI6sb9bY4DfRSy","event_type":"invoice.payment_succeeded"}
[2025-05-13 20:02:17] [EVENT] StripeWebhookController: No se encontró estrategia aplicable. - Context: {"event_type":"invoice.payment_succeeded","event_id":"evt_1ROP1pP71JLI6sb9bY4DfRSy"}
[2025-05-13 20:02:21] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:21] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:21] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:21] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:21] [EVENT] Bootstrap: StripeInvoiceController instanciado.
[2025-05-13 20:02:21] [EVENT] API Invoices: Endpoint alcanzado con acción: list_all
[2025-05-13 20:02:21] [EVENT] API Invoices: Solicitud para listar todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 20:02:21] [EVENT] App\Controller\Impl\StripeInvoiceControllerImpl: Solicitando todas las facturas. - Context: {"page":1,"limit":10}
[2025-05-13 20:02:27] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:27] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:27] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:27] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:27] [EVENT] Bootstrap: GlobalStripeClient instanciado.
[2025-05-13 20:02:27] [EVENT] Bootstrap: StripeSubscriptionManagementService instanciado.
[2025-05-13 20:02:27] [EVENT] Bootstrap: StripeSubscriptionController instanciado.
[2025-05-13 20:02:27] [EVENT] API [api-subscriptions.php]: Solicitud para listar TODAS las suscripciones del sistema. - Context: {"page":1,"limit":5}
[2025-05-13 20:02:27] [EVENT] App\Controller\Impl\StripeSubscriptionControllerImpl: Solicitando todas las suscripciones. - Context: {"page":1,"limit":5}
[2025-05-13 20:02:48] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:48] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:48] [EVENT] Bootstrap: GlobalStripeClient instanciado.
[2025-05-13 20:02:48] [EVENT] Bootstrap: StripeSubscriptionManagementService instanciado.
[2025-05-13 20:02:48] [EVENT] API [api-manage-subscriptions.php]: Solicitud de gestión recibida. - Context: {"action":"cancel_at_period_end","subscription_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:48] [EVENT] App\Service\Impl\StripeSubscriptionManagementServiceImpl: Solicitando cancelación al final del periodo vía API. - Context: {"subscription_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:49] [EVENT] App\Service\Impl\StripeSubscriptionManagementServiceImpl: Suscripción configurada para cancelar al final del periodo (respuesta API). - Context: {"subscription_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX","api_cancel_at_period_end":true}
[2025-05-13 20:02:49] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:49] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:49] [EVENT] Bootstrap: Todas las estrategias (8) instanciadas.
[2025-05-13 20:02:49] [EVENT] StripeWebhookServiceImpl inicializado con 8 estrategias.
[2025-05-13 20:02:49] [EVENT] Bootstrap: StripeWebhookService instanciado.
[2025-05-13 20:02:49] [EVENT] Bootstrap: StripeWebhookController instanciado.
[2025-05-13 20:02:49] [EVENT] StripeWebhookController: Webhook recibido.
[2025-05-13 20:02:49] [EVENT] StripeWebhookService: Intentando construir evento de Stripe.
[2025-05-13 20:02:49] [EVENT] StripeWebhookController: Evento de Stripe construido y verificado. - Context: {"event_id":"evt_1ROP2LP71JLI6sb9iUnDHU3K","event_type":"customer.subscription.updated"}
[2025-05-13 20:02:49] [EVENT] StripeWebhookService: Buscando estrategia para procesar evento. - Context: {"event_id":"evt_1ROP2LP71JLI6sb9iUnDHU3K","event_type":"customer.subscription.updated"}
[2025-05-13 20:02:49] [EVENT] StripeWebhookService: Estrategia encontrada, procesando... - Context: {"event_id":"evt_1ROP2LP71JLI6sb9iUnDHU3K","event_type":"customer.subscription.updated","strategy_class":"App\\Strategy\\Impl\\SubscriptionUpdatedStrategyImpl"}
[2025-05-13 20:02:49] [EVENT] App\Strategy\Impl\SubscriptionUpdatedStrategyImpl: Iniciando procesamiento. - Context: {"event_id":"evt_1ROP2LP71JLI6sb9iUnDHU3K","event_type":"customer.subscription.updated"}
[2025-05-13 20:02:49] [EVENT] SubscriptionMapper DEBUG: Objeto payload recibido. - Context: {"class":"Stripe\\Subscription","json_representation_snippet":"{\n    \"id\": \"sub_1ROP1oP71JLI6sb9M2FhWZGX\",\n    \"object\": \"subscription\",\n    \"application\": null,\n    \"application_fee_percent\": null,\n    \"automatic_tax\": {\n        \"disabled_reason\": null,\n        \"enabled\": false,\n        \"liability\": null\n    },\n    \"billing_cycle_anchor\": 1747166534,\n    \"billing_cycle_anchor_config\": null,\n    \"cancel_at\": 1749844934,\n    \"cancel_at_period_end\": true,\n    \"canceled_at\": 1747166569,\n    \"cancellation_details\": {\n        \"comment\": null,\n        \"feedback\": null,\n        \"reason\": \"cancellation_requested\"\n    },\n    \"collection_method\": \"charge_automatically\",\n    \"created\": 1747166534,\n    \"currency\": \"eur\",\n    \"customer\": \"cus_SJ13BPsY6XHn0L\",\n    \"days_until_due\": null,\n    \"default_payment_method\": \"pm_1ROP1mP71JLI6sb9S5pV2tHO\",\n    \"default_source\": null,\n    \"default_tax_rates\": [],\n    \"description\": null,\n    \"discounts\": [],\n    \"ended_at\": null,\n    \"invoice_settings\": {\n        \"account_tax_ids\": null,\n        \"issuer\": {\n            \""}
[2025-05-13 20:02:49] [EVENT] SubscriptionMapper: Usando 'start_date' como 'current_period_start'. - Context: {"sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:49] [EVENT] SubscriptionMapper: Usando 'items.data[0].current_period_end'. - Context: {"sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:49] [EVENT] App\Strategy\Impl\SubscriptionUpdatedStrategyImpl: Subscription DTO mapeado para actualización. - Context: {"event_id":"evt_1ROP2LP71JLI6sb9iUnDHU3K","sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX","new_status":"active"}
[2025-05-13 20:02:49] [EVENT] App\Strategy\Impl\SubscriptionUpdatedStrategyImpl: Verificando email del cliente desde API. - Context: {"customer_id":"cus_SJ13BPsY6XHn0L"}
[2025-05-13 20:02:50] [EVENT] SubscriptionModelFactory: Actualizando SubscriptionsModel desde SubscriptionDTO. - Context: {"sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX","new_status":"active"}
[2025-05-13 20:02:50] [EVENT] SubscriptionModelFactory: SubscriptionsModel actualizado. - Context: {"sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:50] [EVENT] App\Strategy\Impl\SubscriptionUpdatedStrategyImpl: Suscripción actualizada y guardada. - Context: {"event_id":"evt_1ROP2LP71JLI6sb9iUnDHU3K","sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:50] [EVENT] App\Strategy\Impl\SubscriptionUpdatedStrategyImpl: Procesamiento completado. - Context: {"event_id":"evt_1ROP2LP71JLI6sb9iUnDHU3K","sub_id":"sub_1ROP1oP71JLI6sb9M2FhWZGX"}
[2025-05-13 20:02:50] [EVENT] StripeWebhookService: Estrategia procesada exitosamente. - Context: {"event_id":"evt_1ROP2LP71JLI6sb9iUnDHU3K","strategy_class":"App\\Strategy\\Impl\\SubscriptionUpdatedStrategyImpl"}
[2025-05-13 20:02:50] [EVENT] StripeWebhookController: Webhook procesado exitosamente. - Context: {"event_id":"evt_1ROP2LP71JLI6sb9iUnDHU3K"}
[2025-05-13 20:02:55] [EVENT] Bootstrap: .env cargado.
[2025-05-13 20:02:55] [EVENT] Bootstrap: Inicializado. Constantes definidas.
[2025-05-13 20:02:55] [EVENT] Bootstrap: GlobalStripeClient instanciado.
[2025-05-13 20:02:55] [EVENT] Bootstrap: StripeSubscriptionManagementService instanciado.
[2025-05-13 20:02:55] [EVENT] Bootstrap: StripeSubscriptionController instanciado.
[2025-05-13 20:02:55] [EVENT] API [api-subscriptions.php]: Solicitud para listar TODAS las suscripciones del sistema. - Context: {"page":1,"limit":5}
[2025-05-13 20:02:55] [EVENT] App\Controller\Impl\StripeSubscriptionControllerImpl: Solicitando todas las suscripciones. - Context: {"page":1,"limit":5}
[2025-05-13 23:31:11] [EVENT] Bootstrap: .env cargado.
[2025-05-13 23:31:11] [EVENT] Bootstrap: Inicializado. Constantes definidas.
